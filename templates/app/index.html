{% extends "base.html" %}
{% block title %}Home | CityPulse{% endblock %}
{% load static %}
{% block content %}

<header class="hero">
  <style>
    @keyframes slideshow {
      0%   { background-image: url("{% static 'media/events/default-event.jpg' %}"); }
      25%  { background-image: url("{% static 'media/events/default-event.jpg' %}"); }
      50%  { background-image: url("{% static 'media/events/default-event.jpg' %}"); }
      75%  { background-image: url("{% static 'media/events/default-event.jpg' %}"); }
      100% { background-image: url("{% static 'media/events/default-event.jpg' %}"); }
    }

    .hero {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      background-size: cover;
      background-position: center;
      animation: slideshow 15s infinite ease-in-out;
      padding: 0 2rem;
      overflow: hidden;
      text-align: center;
    }

    .hero-content {
      position: relative;
      color: rgba(255, 255, 255, 0.95);
      z-index: 2;
      max-width: 550px;
      text-align: center;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
    }

    .hero-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }

    .hero-content h2 {
      font-size: 2rem;
      font-weight: 700;
      line-height: 1.2;
      color: rgba(255, 255, 255, 0.85);
    }

    .hero-content p {
      font-size: 1.3rem;
      margin-bottom: 1.5rem;
      color: rgba(255, 255, 255, 0.85);
    }

    .hero-content .btn {
      font-size: 1rem;
      padding: 0.8rem 1.5rem;
      font-weight: 600;
      background: rgba(255, 102, 0, 0.9);
      border: none;
      color: #fff;
      transition: 0.3s ease;
    }

    .hero-content .btn:hover {
      background: rgba(255, 102, 0, 1);
    }

    .ticker {
      position: absolute;
      bottom: 0;
      width: 100%;
      background: rgba(0,0,0,0.6);
      color: #fff;
      overflow: hidden;
      white-space: nowrap;
      padding: 0.5rem 0;
      z-index: 2;
    }

    .ticker-content {
      display: inline-block;
      padding-left: 100%;
      animation: scroll 20s linear infinite;
    }

    @keyframes scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .hero-content h1 { font-size: 2.8rem; }
      .hero-content p { font-size: 1.2rem; }
    }

    @media (max-width: 992px) {
      .hero { justify-content: center; text-align: center; }
      .hero-content { text-align: center; max-width: 90%; }
      .hero-content h1 { font-size: 2.2rem; }
      .hero-content p { font-size: 1rem; }
    }

    @media (max-width: 576px) {
      .hero-content h1 { font-size: 1.8rem; }
      .hero-content p { font-size: 0.95rem; }
      .hero-content .btn { font-size: 0.9rem; padding: 0.6rem 1.2rem; }
    }
  </style>

  <div class="hero-overlay"></div>

  <div class="hero-content">
    <h2>Experience the Joy of Togetherness</h2>
    <p>Join local communities, celebrate traditions, and create unforgettable memories with cultural events near you.</p>
    <a href="{% url 'explore_events' %}" class="btn shadow">Explore Events</a>
  </div>

  <div class="ticker">
    <div class="ticker-content">
      {% for event in events %}
        <span>ðŸ“¢ {{ event.title }} â€“ {{ event.date|date:"M d, Y" }} @ {{ event.location }} &nbsp;&nbsp;&nbsp;</span>
      {% empty %}
        <span>No upcoming events at the moment. Stay tuned!</span>
      {% endfor %}
    </div>
  </div>
</header>

<!-- Today's Festivals -->
<section class="py-5">
  <div class="container">
    <div class="text-center mb-4">
      <h2 class="fw-bold text-orange">Todayâ€™s Festivals</h2>
    </div>

    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4 mb-5">
      {% for festival in festivals|slice:":4" %}
        {% if festival.is_active %}
        <div class="col d-flex align-items-stretch">
          <div class="card festival-card shadow-sm h-100 border-0">
            {% if festival.image %}
              <img src="{{ festival.image.url }}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% else %}
              <img src="{% static 'media/events/default.jpg' %}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% endif %}
            <div class="card-body text-center py-3">
              <h6 class="fw-bold mb-1">{{ festival.name }}</h6>
              <p class="small text-muted mb-1">{{ festival.description|truncatewords:10 }}</p>
              <p class="mb-0"><strong>Date:</strong> {{ festival.date|date:"M j, Y" }}</p>
              <p class="mb-0"><strong>Location:</strong> {{ festival.location }}</p>
              {% if festival.organizer %}
                <p class="mb-0"><strong>Organizer:</strong> {{ festival.organizer }}</p>
              {% endif %}
            </div>
          </div>
        </div>
        {% endif %}
      {% endfor %}
    </div>

    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
      {% for festival in festivals|slice:"4:" %}
        {% if festival.is_active %}
        <div class="col d-flex align-items-stretch">
          <div class="card festival-card shadow-sm h-100 border-0">
            {% if festival.image %}
              <img src="{{ festival.image.url }}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% else %}
              <img src="{% static 'media/events/default.jpg' %}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% endif %}
            <div class="card-body text-center py-3">
              <h6 class="fw-bold mb-1">{{ festival.name }}</h6>
              <p class="small text-muted mb-1">{{ festival.description|truncatewords:10 }}</p>
              <p class="mb-0"><strong>Date:</strong> {{ festival.date|date:"M j, Y" }}</p>
              <p class="mb-0"><strong>Location:</strong> {{ festival.location }}</p>
              {% if festival.organizer %}
                <p class="mb-0"><strong>Organizer:</strong> {{ festival.organizer }}</p>
              {% endif %}
            </div>
          </div>
        </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<!-- Upcoming Events -->
<section class="py-5">
  <div class="container text-center">
    <h2 class="mb-4 fw-bold text-orange">Upcoming Events</h2>

    <div class="row g-4">
      {% for event in events %}
      <div class="col-12 col-sm-6 col-md-3 d-flex align-items-stretch">
        <div class="card shadow-sm h-100">
          {% if event.image %}
            <img src="{{ event.image.url }}" class="card-img-top" alt="{{ event.title }}">
          {% else %}
            <img src="{% static 'media/events/default-event.jpg' %}" class="card-img-top" alt="Default Event">
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ event.title }}</h5>
            <p class="card-text">{{ event.description|truncatewords:7 }}</p>
            <p class="small text-muted mb-2">
              <strong>Date:</strong> {{ event.date|date:"M d, Y" }}<br>
              <strong>Location:</strong> {{ event.location }}
            </p>
            <a href="{% url 'event_detail' event.id %}" class="btn btn-orange w-100 mb-2 mt-auto">Read More</a>
          </div>
        </div>
      </div>
      {% empty %}
        <p class="text-muted mt-4">No upcoming events right now.</p>
      {% endfor %}
    </div>
  </div>
</section>

{% endblock %}
